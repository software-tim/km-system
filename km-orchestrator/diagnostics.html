﻿<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KM Orchestrator - System Diagnostics</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .header h1 {
            color: #333;
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header p {
            color: #666;
            font-size: 1.1rem;
        }

        .diagnostic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .diagnostic-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .diagnostic-card h3 {
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-working { background: #10b981; }
        .status-broken { background: #ef4444; }
        .status-partial { background: #f59e0b; }
        .status-unknown { background: #6b7280; }

        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px 5px 5px 0;
            font-size: 0.9rem;
            transition: background 0.3s ease;
        }

        .test-button:hover {
            background: #5a67d8;
        }

        .test-button.working {
            background: #10b981;
        }

        .test-button.broken {
            background: #ef4444;
        }

        .test-button.partial {
            background: #f59e0b;
        }

        .test-response {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .service-health {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .service-name {
            font-weight: bold;
        }

        .service-url {
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            color: #666;
        }

        .endpoint-test {
            margin-bottom: 15px;
            padding: 15px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
        }

        .endpoint-path {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .refresh-all {
            background: #8b5cf6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            margin-bottom: 20px;
        }

        .refresh-all:hover {
            background: #7c3aed;
        }

        .summary-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .summary-stat {
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            background: #f8fafc;
        }

        .summary-stat .number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .summary-stat .label {
            color: #666;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔧 KM Orchestrator System Diagnostics</h1>
            <p>Comprehensive testing and monitoring of all orchestrator capabilities and underlying services</p>
        </div>

        <button class="refresh-all" onclick="runAllDiagnostics()">🔄 Run All Diagnostics</button>

        <div class="summary-section">
            <h2>📊 System Health Summary</h2>
            <div class="summary-grid">
                <div class="summary-stat">
                    <div class="number working" id="workingCount">-</div>
                    <div class="label">Working</div>
                </div>
                <div class="summary-stat">
                    <div class="number broken" id="brokenCount">-</div>
                    <div class="label">Broken</div>
                </div>
                <div class="summary-stat">
                    <div class="number partial" id="partialCount">-</div>
                    <div class="label">Partial</div>
                </div>
                <div class="summary-stat">
                    <div class="number" id="totalCount">-</div>
                    <div class="label">Total Tests</div>
                </div>
            </div>
        </div>

        <div class="diagnostic-grid">
            <!-- Orchestrator Core Functions -->
            <div class="diagnostic-card">
                <h3>🎯 Orchestrator Core Functions</h3>
                <div class="endpoint-test">
                    <div class="endpoint-path">GET /health</div>
                    <button class="test-button" onclick="testEndpoint('/health', 'health-result')">Test Health Check</button>
                    <div class="test-response" id="health-result">Click test to check...</div>
                </div>
                <div class="endpoint-test">
                    <div class="endpoint-path">GET /services/status</div>
                    <button class="test-button" onclick="testEndpoint('/services/status', 'services-result')">Test Services Status</button>
                    <div class="test-response" id="services-result">Click test to check...</div>
                </div>
                <div class="endpoint-test">
                    <div class="endpoint-path">POST /api/chat</div>
                    <button class="test-button" onclick="testChat('orchestrator-chat-result')">Test Chat Function</button>
                    <div class="test-response" id="orchestrator-chat-result">Click test to check...</div>
                </div>
            </div>

            <!-- Document Management -->
            <div class="diagnostic-card">
                <h3>📄 Document Management</h3>
                <div class="endpoint-test">
                    <div class="endpoint-path">POST /api/upload</div>
                    <button class="test-button" onclick="testDocumentUpload('upload-result')">Test Document Upload</button>
                    <div class="test-response" id="upload-result">Click test to check...</div>
                </div>
                <div class="endpoint-test">
                    <div class="endpoint-path">km-mcp-sql-docs /tools/store-document</div>
                    <button class="test-button" onclick="testDirectDocumentStore('direct-store-result')">Test Direct Store</button>
                    <div class="test-response" id="direct-store-result">Click test to check...</div>
                </div>
                <div class="endpoint-test">
                    <div class="endpoint-path">km-mcp-sql-docs /stats</div>
                    <button class="test-button" onclick="testDocumentStats('doc-stats-result')">Test Document Stats</button>
                    <div class="test-response" id="doc-stats-result">Click test to check...</div>
                </div>
            </div>

            <!-- Search Functions -->
            <div class="diagnostic-card">
                <h3>🔍 Search Functions</h3>
                <div class="endpoint-test">
                    <div class="endpoint-path">POST /api/search</div>
                    <button class="test-button" onclick="testSearch('search-result')">Test Orchestrator Search</button>
                    <div class="test-response" id="search-result">Click test to check...</div>
                </div>
                <div class="endpoint-test">
                    <div class="endpoint-path">km-mcp-sql-docs /tools/search-documents</div>
                    <button class="test-button" onclick="testDirectSearch('direct-search-result')">Test Direct Search</button>
                    <div class="test-response" id="direct-search-result">Click test to check...</div>
                </div>
                <div class="endpoint-test">
                    <div class="endpoint-path">km-mcp-search service</div>
                    <button class="test-button" onclick="testSearchService('search-service-result')">Test Search Service</button>
                    <div class="test-response" id="search-service-result">Click test to check...</div>
                </div>
            </div>

            <!-- AI & LLM Functions -->
            <div class="diagnostic-card">
                <h3>🤖 AI & LLM Functions</h3>
                <div class="endpoint-test">
                    <div class="endpoint-path">km-mcp-llm /health</div>
                    <button class="test-button" onclick="testLLMHealth('llm-health-result')">Test LLM Health</button>
                    <div class="test-response" id="llm-health-result">Click test to check...</div>
                </div>
                <div class="endpoint-test">
                    <div class="endpoint-path">POST /api/analyze</div>
                    <button class="test-button" onclick="testAnalyze('analyze-result')">Test Analysis Endpoint</button>
                    <div class="test-response" id="analyze-result">Click test to check...</div>
                </div>
                <div class="endpoint-test">
                    <div class="endpoint-path">km-mcp-llm RAG functionality</div>
                    <button class="test-button" onclick="testRAG('rag-result')">Test RAG Pipeline</button>
                    <div class="test-response" id="rag-result">Click test to check...</div>
                </div>
            </div>

            <!-- Knowledge Graphs -->
            <div class="diagnostic-card">
                <h3>🌐 Knowledge Graphs</h3>
                <div class="endpoint-test">
                    <div class="endpoint-path">km-mcp-graphrag /health</div>
                    <button class="test-button" onclick="testGraphRAGHealth('graphrag-health-result')">Test GraphRAG Health</button>
                    <div class="test-response" id="graphrag-health-result">Click test to check...</div>
                </div>
                <div class="endpoint-test">
                    <div class="endpoint-path">km-mcp-graphrag /build-graph</div>
                    <button class="test-button" onclick="testBuildGraph('build-graph-result')">Test Build Graph</button>
                    <div class="test-response" id="build-graph-result">Click test to check...</div>
                </div>
                <div class="endpoint-test">
                    <div class="endpoint-path">km-mcp-graphrag /relationships</div>
                    <button class="test-button" onclick="testRelationships('relationships-result')">Test Relationships</button>
                    <div class="test-response" id="relationships-result">Click test to check...</div>
                </div>
            </div>

            <!-- Service Connectivity -->
            <div class="diagnostic-card">
                <h3>🔗 Service Connectivity</h3>
                <div class="service-health">
                    <div>
                        <div class="service-name">km-mcp-sql-docs</div>
                        <div class="service-url">https://km-mcp-sql-docs.azurewebsites.net</div>
                    </div>
                    <button class="test-button" onclick="testServiceConnectivity('km-mcp-sql-docs', 'docs-connectivity')">Test</button>
                </div>
                <div class="test-response" id="docs-connectivity">Not tested</div>

                <div class="service-health">
                    <div>
                        <div class="service-name">km-mcp-search</div>
                        <div class="service-url">https://km-mcp-search.azurewebsites.net</div>
                    </div>
                    <button class="test-button" onclick="testServiceConnectivity('km-mcp-search', 'search-connectivity')">Test</button>
                </div>
                <div class="test-response" id="search-connectivity">Not tested</div>

                <div class="service-health">
                    <div>
                        <div class="service-name">km-mcp-llm</div>
                        <div class="service-url">https://km-mcp-llm.azurewebsites.net</div>
                    </div>
                    <button class="test-button" onclick="testServiceConnectivity('km-mcp-llm', 'llm-connectivity')">Test</button>
                </div>
                <div class="test-response" id="llm-connectivity">Not tested</div>

                <div class="service-health">
                    <div>
                        <div class="service-name">km-mcp-graphrag</div>
                        <div class="service-url">https://km-mcp-graphrag.azurewebsites.net</div>
                    </div>
                    <button class="test-button" onclick="testServiceConnectivity('km-mcp-graphrag', 'graphrag-connectivity')">Test</button>
                </div>
                <div class="test-response" id="graphrag-connectivity">Not tested</div>
            </div>
        </div>
    </div>

    <script>
        let testResults = {};

        // Generic endpoint tester
        async function testEndpoint(endpoint, resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing...';
            
            try {
                const response = await fetch(endpoint);
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, 'working');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Test chat functionality
        async function testChat(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing chat...';
            
            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: 'test query for diagnostics' })
                });
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, data.status === 'error' ? 'broken' : 'working');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Test document upload
        async function testDocumentUpload(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing document upload...';
            
            try {
                const testDoc = {
                    title: 'Diagnostic Test Document',
                    content: 'This is a test document for diagnostic purposes.',
                    classification: 'Test',
                    entities: 'diagnostics, test',
                    metadata: '{"source": "diagnostics"}'
                };
                
                const response = await fetch('/api/upload', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testDoc)
                });
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, data.status === 'error' ? 'broken' : 'working');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Test search functionality
        async function testSearch(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing search...';
            
            try {
                const response = await fetch('/api/search', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ query: 'test', limit: 3 })
                });
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, response.ok ? 'working' : 'broken');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Test direct document store
                // Test direct document store
        async function testDirectDocumentStore(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing direct document store...';
            
            try {
                // FIX: Use JSON instead of FormData
                const testDoc = {
                    title: 'Direct Test Document',
                    content: 'This is a direct test to the document service.',
                    file_type: 'text',
                    metadata: {
                        source: 'dashboard_test',
                        classification: 'Test'
                    }
                };
                
                const response = await fetch('https://km-mcp-sql-docs.azurewebsites.net/tools/store-document', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testDoc)
                });
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, response.ok ? 'working' : 'broken');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }async function testDirectSearch(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing direct search...';
            
            try {
                const response = await fetch('https://km-mcp-sql-docs.azurewebsites.net/tools/search-documents', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ query: 'test', limit: 3 })
                });
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, response.ok ? 'working' : 'broken');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Test document stats
                // Test document stats
        async function testDocumentStats(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing document stats...';
            
            try {
                // FIX: Use /tools/database-stats instead of /stats
                const response = await fetch('https://km-mcp-sql-docs.azurewebsites.net/tools/database-stats');
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, response.ok ? 'working' : 'broken');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }async function testSearchService(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing search service...';
            
            try {
                const response = await fetch('https://km-mcp-search.azurewebsites.net/health');
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, response.ok ? 'working' : 'broken');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Test LLM health
        async function testLLMHealth(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing LLM health...';
            
            try {
                const response = await fetch('https://km-mcp-llm.azurewebsites.net/health');
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, response.ok ? 'working' : 'broken');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Test analyze endpoint
        async function testAnalyze(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing analyze endpoint...';
            
            try {
                const response = await fetch('/api/analyze', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ type: 'test', content: 'diagnostic test' })
                });
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, response.ok ? 'working' : 'broken');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Test RAG pipeline
        async function testRAG(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing RAG pipeline...';
            
            try {
                // This would test the RAG functionality if available
                const response = await fetch('https://km-mcp-llm.azurewebsites.net/rag', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ query: 'test query', documents: [] })
                });
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, response.ok ? 'working' : 'broken');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Test GraphRAG health
        async function testGraphRAGHealth(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing GraphRAG health...';
            
            try {
                const response = await fetch('https://km-mcp-graphrag.azurewebsites.net/health');
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, response.ok ? 'working' : 'broken');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Test build graph
        async function testBuildGraph(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing build graph...';
            
            try {
                const response = await fetch('https://km-mcp-graphrag.azurewebsites.net/build-graph', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ source: 'test_documents' })
                });
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, response.ok ? 'working' : 'broken');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Test relationships
        async function testRelationships(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing relationships...';
            
            try {
                const response = await fetch('https://km-mcp-graphrag.azurewebsites.net/relationships', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ entity: 'test' })
                });
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, response.ok ? 'working' : 'broken');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Test service connectivity
        async function testServiceConnectivity(serviceName, resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.textContent = 'Testing connectivity...';
            
            const serviceUrls = {
                'km-mcp-sql-docs': 'https://km-mcp-sql-docs.azurewebsites.net',
                'km-mcp-search': 'https://km-mcp-search.azurewebsites.net',
                'km-mcp-llm': 'https://km-mcp-llm.azurewebsites.net',
                'km-mcp-graphrag': 'https://km-mcp-graphrag.azurewebsites.net'
            };
            
            try {
                const response = await fetch(`${serviceUrls[serviceName]}/health`);
                const data = await response.json();
                resultDiv.textContent = JSON.stringify(data, null, 2);
                markTestResult(resultId, response.ok ? 'working' : 'broken');
            } catch (error) {
                resultDiv.textContent = `Error: ${error.message}`;
                markTestResult(resultId, 'broken');
            }
        }

        // Mark test result and update button appearance
        function markTestResult(testId, status) {
            testResults[testId] = status;
            const button = document.querySelector(`button[onclick*="${testId}"]`);
            if (button) {
                button.className = `test-button ${status}`;
            }
            updateSummary();
        }

        // Update summary counts
        function updateSummary() {
            const working = Object.values(testResults).filter(r => r === 'working').length;
            const broken = Object.values(testResults).filter(r => r === 'broken').length;
            const partial = Object.values(testResults).filter(r => r === 'partial').length;
            const total = Object.values(testResults).length;

            document.getElementById('workingCount').textContent = working;
            document.getElementById('brokenCount').textContent = broken;
            document.getElementById('partialCount').textContent = partial;
            document.getElementById('totalCount').textContent = total;

            // Update colors
            document.getElementById('workingCount').className = 'number working';
            document.getElementById('brokenCount').className = 'number broken';
            document.getElementById('partialCount').className = 'number partial';
        }

        // Run all diagnostics
        async function runAllDiagnostics() {
            const tests = [
                () => testEndpoint('/health', 'health-result'),
                () => testEndpoint('/services/status', 'services-result'),
                () => testChat('orchestrator-chat-result'),
                () => testDocumentUpload('upload-result'),
                () => testDirectDocumentStore('direct-store-result'),
                () => testDocumentStats('doc-stats-result'),
                () => testSearch('search-result'),
                () => testDirectSearch('direct-search-result'),
                () => testSearchService('search-service-result'),
                () => testLLMHealth('llm-health-result'),
                () => testAnalyze('analyze-result'),
                () => testRAG('rag-result'),
                () => testGraphRAGHealth('graphrag-health-result'),
                () => testBuildGraph('build-graph-result'),
                () => testRelationships('relationships-result'),
                () => testServiceConnectivity('km-mcp-sql-docs', 'docs-connectivity'),
                () => testServiceConnectivity('km-mcp-search', 'search-connectivity'),
                () => testServiceConnectivity('km-mcp-llm', 'llm-connectivity'),
                () => testServiceConnectivity('km-mcp-graphrag', 'graphrag-connectivity')
            ];

            // Run tests with delays to avoid overwhelming services
            for (let i = 0; i < tests.length; i++) {
                tests[i]();
                await new Promise(resolve => setTimeout(resolve, 500)); // 500ms delay between tests
            }
        }
    </script>
</body>
</html>


